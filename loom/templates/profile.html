{% extends "base.html" %}

{% block title %}Profile â€” Loom{% endblock %}

{% block content %}
<h1>Your Profile</h1>

<form method="post" action="/profile">
  <div>
    <label for="display_name">Display Name</label><br>
    <input type="text" id="display_name" name="display_name"
           value="{{ profile_user.display_name }}" maxlength="100" required>
  </div>

  <div style="margin-top:0.75rem;">
    <label>
      <input type="checkbox" name="notify_enabled" value="true"
             {% if profile_user.notify_enabled %}checked{% endif %}>
      Enable in-app notifications
    </label>
  </div>

  <div style="margin-top:1rem;">
    <p style="margin:0 0 0.4rem; font-weight:bold;">Prose suggestions</p>
    <p style="margin:0 0 0.5rem; font-size:0.87rem; color:#555;">When to offer an AI-generated prose expansion after you submit a beat.</p>
    <label style="display:block; margin-bottom:0.25rem;">
      <input type="radio" name="prose_mode" value="always"
             {% if profile_user.prose_mode == "always" %}checked{% endif %}>
      Always suggest
    </label>
    <label style="display:block; margin-bottom:0.25rem;">
      <input type="radio" name="prose_mode" value="never"
             {% if profile_user.prose_mode == "never" %}checked{% endif %}>
      Never suggest
    </label>
    <label style="display:block; margin-bottom:0.4rem;">
      <input type="radio" name="prose_mode" value="threshold"
             {% if profile_user.prose_mode == "threshold" %}checked{% endif %}>
      Only when beat is under
      <input type="number" name="prose_threshold_words" min="1" max="500"
             value="{{ profile_user.prose_threshold_words }}"
             style="width:4rem; margin:0 0.25rem;">
      words
    </label>
  </div>

  <div style="margin-top:1rem;">
    <button type="submit">Save</button>
  </div>
</form>

<h2 style="margin-top:2rem;">Your Games</h2>
{% if profile_user.memberships %}
<ul>
  {% for membership in profile_user.memberships %}
  <li>
    <a href="/games/{{ membership.game.id }}">{{ membership.game.name }}</a>
    <small>({{ membership.role }})</small>
  </li>
  {% endfor %}
</ul>
{% else %}
<p>You haven't joined any games yet. <a href="/games">Browse games</a>.</p>
{% endif %}

<hr style="margin:2rem 0;">
<form method="post" action="/logout">
  <button type="submit">Sign Out</button>
</form>
{% endblock %}
